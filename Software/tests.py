from network import Net
from convLayer import ConvLayer
import numpy as np

################################################################################
# Test Kernel Wire Export
################################################################################
k0z0=np.array([[1,1,2,2],[1,1,2,2],[2,2,1,1],[2,2,1,1]])
k0z1=np.ones((4,4),dtype=int,order='C')*3
k1z0=np.array([[2,2,3,3],[2,2,3,3],[2,2,3,3],[2,2,3,3]])
k1z1=np.ones((4,4),dtype=int,order='C')*4

kernels = np.ndarray(shape=(4,4,2,2),dtype=int,order='C')
kernels[:,:,0,0] = k0z0
kernels[:,:,1,0] = k0z1
kernels[:,:,0,1] = k1z0
kernels[:,:,1,1] = k1z1

"""
kernels = np.ndarray(shape=(4,4,2,2),[[[[1, 2],
         [3, 4]],
        [[1, 2],
         [3, 4]],
        [[2, 3],
         [3, 4]],
        [[2, 3],
         [3, 4]]],
       [[[1, 2],
         [3, 4]],
        [[1, 2],
         [3, 4]],
        [[2, 3],
         [3, 4]],
        [[2, 3],
         [3, 4]]],
       [[[2, 2],
         [3, 4]],
        [[2, 2],
         [3, 4]],
        [[1, 3],
         [3, 4]],
        [[1, 3],
         [3, 4]]],
       [[[2, 2],
         [3, 4]],
        [[2, 2],
         [3, 4]],
        [[1, 3],
         [3, 4]],
        [[1, 3],
         [3, 4]]]])
"""
test_layer = ConvLayer("K_TEST", 4, 4, 2, 2, 28, 28, 2, 1,1024,-1024,kernels)
print test_layer.write_kernel_wire()

################################################################################

"""
nn.add_conv("layer1", 4, 4, 10, 28, 28, 1,1024,-1024,k)
nn.add_conv("layer2", 3, 3, 11, 25, 25, 1,2048,-2048,k)
nn.add_conv("layer1", 2, 2, 12, 19, 19, 1,300,-300,k)
"""
#print nn.write_cnn_module()
